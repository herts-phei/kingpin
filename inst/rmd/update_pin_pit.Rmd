---
title: "Update pin_pit"
output: html_document
---

Instructions:

- Make sure you have kingpin installed
- Make sure you have CONNECT_SERVER and CONNECT_API_KEY_PHINTEL environmental variables in your .Renviron file
- Deploy this .Rmd to your RSConnect board and schedule to run every day at the time of your choosing. 

```{r update}

library(kingpin)

board <- board_rsconnect(Sys.getenv("CONNECT_SERVER"), Sys.getenv("CONNECT_API_KEY_PHINTEL"))
pin_pit <- kingpin::pin_return(board, "pin_pit")

# LOOP THROUGH EACH PIN 
for (i in 1:length(pin_pit)) {
  
  # remove if countdown reached
  if (grepl("0", pin_pit[[i]]$countdown)) {
    
    pin_pit[[i]] <- NULL
    
  }
  
}

kingpin::pin_throw(board, "pin_pit")

```
